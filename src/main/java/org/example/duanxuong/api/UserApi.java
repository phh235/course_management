package org.example.duanxuong.api;import org.example.duanxuong.entity.LoginRequest;import org.example.duanxuong.entity.ResponseObject;import org.example.duanxuong.entity.User;import org.example.duanxuong.service.UserService;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.core.io.ClassPathResource;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.web.bind.annotation.*;import org.springframework.web.multipart.MultipartFile;import java.io.File;import java.util.HashMap;import java.util.Map;@RestController@RequestMapping("/user-api")public class UserApi {    @Autowired    public UserService userService;    @GetMapping("/getAllUser")    public ResponseEntity<?> doGetAllUser() {        Map<String, Object> result = new HashMap<>();        try {            result = new HashMap<>();            result.put("success", true);            result.put("status", "Call Api success");            result.put("data", userService.findAllUser());        } catch (Exception e) {            result.put("error", false);            result.put("status", "Call Api error");            result.put("data", null);            System.out.println(e);        }        return ResponseEntity.ok(result);    }    @PostMapping("/postSaveUser")    public ResponseEntity<?> doPostSaveUser(@RequestBody User user) {        Map<String, Object> result = new HashMap<>();        try {            result = new HashMap<>();            result.put("success", true);            result.put("status", "Call Api success");            result.put("data", userService.doSaveUser(user));        } catch (Exception e) {            result.put("error", false);            result.put("status", "Call Api error");            result.put("data", null);            System.out.println(e);        }        return ResponseEntity.ok(result);    }    @GetMapping("/getUserByUsername/{username}")    public ResponseEntity<?> doGetUserByUsername(@PathVariable String username) {        Map<String, Object> result = new HashMap<>();        try {            result.put("success", true);            result.put("status", "Call Api success");            result.put("data", userService.findByUsername(username));        } catch (Exception e) {            result.put("error", false);            result.put("status", "Call Api error");            result.put("data", null);            System.out.println(e);        }        return ResponseEntity.ok(result);    }    @DeleteMapping("/deleteUserById/{id}")    public ResponseEntity<?> doDeleteUserById(@PathVariable int id) {        Map<String, Object> result = new HashMap<>();        try {            result.put("success", true);            result.put("status", "Call Api success");            userService.doDeleteUserById(id);        } catch (Exception e) {            result.put("error", false);            result.put("status", "Call Api error");            result.put("data", null);            System.out.println(e);        }        return ResponseEntity.ok(result);    }    @PostMapping("/uploadFile")    public ResponseEntity<?> uploadFile(@RequestParam("file") MultipartFile file) {        Map<String, Object> result = new HashMap<>();        try {            // Đường dẫn tương đối tới thư mục assets/img            String relativePath = "assets/img/";            ClassPathResource resource = new ClassPathResource(relativePath);            String uploadDir = resource.getFile().getAbsolutePath();            // Tạo thư mục nếu chưa tồn tại            File directory = new File(uploadDir);            if (!directory.exists()) {                directory.mkdirs();            }            // Tên file gốc            String fileName = file.getOriginalFilename();            // Đường dẫn file đầy đủ            String filePath = uploadDir + fileName;            // Lưu file vào đường dẫn            file.transferTo(new File(filePath));            result.put("success", true);            result.put("status", "File uploaded successfully");            result.put("data", fileName);        } catch (Exception e) {            result.put("error", false);            result.put("status", "File upload failed");            result.put("data", null);            System.out.println(e);        }        return ResponseEntity.ok(result);    }}